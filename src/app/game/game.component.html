<div class="game-root" [class.dialog-open]="isDialogOpen">

  <!-- PLAYER LIST -->
  <div class="players">
    <app-player *ngFor="let p of game.players; let i = index" [name]="p.name" [avatar]="p.avatar"
      [playerActive]="i === game.currentPlayer" [compact]="isMobile" (edit)="openEditPlayerDialog(i)"></app-player>
  </div>

  <!-- GAME FIELD -->
  <section class="field" [class.mobile]="isMobile">
    <div class="card-stack" [class.frozen]="isGameOver">

      <!-- Obere Karte / zum Ziehen -->
      <img (click)="!isGameOver && takeCard()" class="top-card" src="assets/img/cards/card_cover.png" alt="Top Card" />

      <!-- Ablagestapel: nur die letzte Karte anzeigen -->
      <img *ngIf="game.playedCard.length && !isGameOver" class="played-card"
        [src]="'assets/img/cards/' + game.playedCard[game.playedCard.length - 1] + '.png'"
        alt="Discard Pile Top Card" />

      <!-- Animierte Karte -->
      <img *ngIf="pickCardAnimation && !isGameOver" class="pick-card"
        [src]="'assets/img/cards/' + game.currentCard + '.png'" alt="Picked Card" />

    </div>
  </section>

  <!-- GAME INFO -->
  <div class="game-info-wrapper">
    <app-game-info [card]="game.currentCard"></app-game-info>
  </div>

  <!-- ADD PLAYER BUTTON -->
  <button mat-fab class="add-player-button game-fab" (click)="openAddPlayerDialog()" [disabled]="isDialogOpen"
    aria-label="Add player">
    <mat-icon>add</mat-icon>
  </button>

  <!-- GAME OVER OVERLAY -->
  <div class="gameover-overlay" *ngIf="isGameOver">
    <div class="gameover-card">
      <img class="gameover-img" src="assets/img/gameover.png" alt="Game Over">

      <h2>Game Over</h2>
      <p>Deck ist leer. Nochmal spielen?</p>

      <div class="gameover-actions">
        <button mat-raised-button color="primary" (click)="restartGame()">
          Restart
        </button>
      </div>
    </div>
  </div>

</div>